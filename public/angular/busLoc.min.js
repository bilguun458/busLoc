(function(){"use strict";angular.module("busLocApp",["ngRoute"]);t.$inject=["$routeProvider"];function t(t){t.when("/",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/route",{templateUrl:"route/route.view.html",controller:"routeCtrl",controllerAs:"vm"}).when("/about",{templateUrl:"about/about.view.html",controller:"aboutCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"})}angular.module("busLocApp").config(["$routeProvider",t])})();(function(){"use strict";angular.module("busLocApp").controller("homeCtrl",t);t.$inject=["$scope","transdepData","googleDirection","$sce","$window"];function t(t,e,n,o,i){var a=this;var r=new google.maps.DirectionsService;var s=new google.maps.DirectionsRenderer;var u="/images/pin.png";var c="AIzaSyCjCauLhho2YsU-lRT4XZC91PIBwqhO-48";e.getRoutes().then(function(t){a.routes=t.data;a.parseData()}).catch(function(t){console.log(t)});a.parseData=function(){a.departures=[];for(var t=0;t<a.routes.length;t++)for(var e=0;e<a.routes[t].departures.length;e++){a.departures.push({origin:a.routes[t].origin.name,destination:a.routes[t].destination.name,date:a.routes[t].departures[e].date,bus:a.routes[t].departures[e].bus})}};a.search=function(t){e.getBusLocation(t).then(function(t){a.busLoc=t.data;a.getRemainingTime()}).catch(function(t){a.searchMessage="Хайлт олдсонгүй";console.log(err)});e.getPointsByLNumber(t).then(function(t){a.origin=t.data.origin;a.destination=t.data.destination;a.waypoints=t.data.waypoints;if(a.waypoints===undefined){a.searchMessage="Хайлт олдсонгүй"}else{a.searchMessage="Чиглэл: "+t.data.origin.name+"-"+t.data.destination.name;a.calculateAndDisplayRoute()}}).catch(function(t){a.searchMessage="Хайлт олдсонгүй";console.log(t)})};a.getRemainingTime=function(){};a.calculateAndDisplayRoute=function(){a.busMarker=new google.maps.Marker({position:a.busLoc,map:a.map,title:"Автобус",animation:google.maps.Animation.DROP,label:"Bus"});var t={origin:a.origin.lat+", "+a.origin.lng,destination:a.destination.lat+", "+a.destination.lng,travelMode:"DRIVING",waypoints:[]};a.waypoints.forEach(function(e){t.waypoints.push({location:e.lat+", "+e.lng,stopover:true})});r.route(t,function(t,e){if(e==="OK"){s.setDirections(t)}else{window.alert("Directions request failed due to "+e)}})};i.initMap=function(){a.map=new google.maps.Map(document.getElementById("map"),{zoom:7,center:{lat:47.918958,lng:106.917622}});s.setMap(a.map)};i.initMap()}})();(function(){angular.module("busLocApp").controller("aboutCtrl",t);t.$inject=["$sce"];function t(t){var e=this;e.main={title:"Автотээврийн үндэсний төвийн системээс авах өгөгдлийн талаар"};e.main.title=t.trustAsHtml(e.main.title);e.main.content=t.trustAsHtml(e.main.content.replace(/\n/g,"<br/>"))}})();(function(){"use strict";angular.module("busLocApp").controller("routeCtrl",t);t.$inject=["$scope","transdepData"];function t(t,e){var n=this;e.getStations().then(function(t){n.stations=t.data}).catch(function(t){console.log(t)});e.getRoutes().then(function(t){n.routes=t.data}).catch(function(t){console.log(t)})}})();(function(){angular.module("busLocApp").directive("navigation",t);function t(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){"use strict";angular.module("busLocApp").service("transdepData",t);t.$inject=["$http"];function t(t){var e=this;e.getStations=function(){return t.get("api/route/stations")};e.getRoutes=function(){return t.get("api/route/routes")};e.getPointsByLNumber=function(e){return t.get("api/route/routes/points/"+e)};e.getBusLocation=function(e){return t.get("api/route/bus/"+e)}}})();(function(){"use strict";angular.module("busLocApp").service("googleDirection",t);t.$inject=["$http"];function t(t){var e=this;e.remainingTime=function(e,n,o){return t.get("https://maps.googleapis.com/maps/api/distancematrix/json",{params:{units:"metre",origins:e,destinations:n,key:o}})}}})();(function(){"use strict";angular.module("busLocApp").filter("dateInMillis",t);function t(){return function(t){return Date.parse(t)}}})();(function(){angular.module("busLocApp").filter("addHtmlLineBreaks",t);function t(){return function(t){var e=String(t).replace(/\n/g,"<br/>");return e}}})();